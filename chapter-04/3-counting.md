# Redis에서 다양한 Counting 기능 만들기
## 1. 좋아요 처리
좋아요를 단순히 개수로 표현하고자 하면, 특정 키에 대한 원자적 연산으로 관리할 수 있을 것이다. 그러나 특정 유저가 좋아요를 했는지 안했는지를 반영해야 하는 상황이 있다.


해당 상황은 게시글이나 댓글을 기준으로, Set을 통해서 구현할 수 있다. `SADD`를 통해 `user_id`를 추가하면 되고, `SCARD` 연산을 통해 전체 좋아요 수를 가져올 수 있다.

---
## 2. 읽지 않은 메시지 수 카운팅
채팅 메시지는 빠르게 쌓인다. 해당 정보를 매번 DB에 반영한다면 DB에 쓰기와 변경이 자주 일어날 수 있다. 따라서, Redis 등에 일시적으로 저장하고 필요한 시점에 한 번에 반영할 수도 있다.



---
## 3. DAU 구하기
Redis의 Bitmap을 사용하여 실시간 DAU를 측정할 수 있다. (이 때 사용자 아이디는 0 이상의 정수형이어야 한다.)


레디스 string의 최대 길이는 512MB이기 때문에, 하나의 키를 사용해 1천 만명 정도의 사용자를 카운팅 할 수 있다. (약 1.2MB 소모)


---
## 4. hyperloglog를 이용한 애플리케이션 미터링
Redis hyperloglog를 사용하면 특정 API 호출 횟수를 쉽게 알 수 있다.

- 특정 유저의 월별 API 호출 횟수를 계산하는 방법
- user_id를 구분 키로 사용, API 호출할 때마다 생성되는 로그의 유일한 식별자를 hyperloglog에 저장할 수 있다.